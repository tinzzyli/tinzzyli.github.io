---
layout: post
title:  Database Chapter 1
date:   2023-04-14 08:00:00
description: 
tags: Lecture_Notes 
categories: Database mysql
---

# Introduction to Database Techniques

In the world of database management, there are several key concepts that are critical to understand in order to create efficient and effective database systems.

## Primary Key

A primary key is a unique identifier for a record in a database table. It is used to ensure that each record can be uniquely identified and accessed. There are several types of primary keys usage in a database system:

- ***NULL***

A primary key that allows ***NULL values*** can create issues with data consistency and referential integrity. It is generally recommended to avoid using NULL as a primary key.

- ***Composite Primary Key***

A composite primary key is a primary key that is made up of two or more columns. This can be useful when a single column cannot uniquely identify a record, but a combination of columns can.

```sql
CREATE TABLE my_table (
  id INT NOT NULL,
  date DATE NOT NULL,
  PRIMARY KEY (id, date)
);
```

- ***Muliple primary keys***

Multiple primary keys are not supported in MySQL. It is generally recommended to use a composite primary key instead.

- ***How to choose primary key***

When selecting a primary key, it is important to choose a key that is ***unique*** and ***stable***. It should also be a value that will not change over time, as this can create issues with referential integrity.

## Identity Column

An identity column is a column in a database table that is automatically generated by the database management system. This can be useful for creating unique identifiers for records in a table.

- ***Auto-increment*** and ***Sequence***

- Auto-increment is a feature in MySQL that automatically generates a unique number for a column in a table. Sequences are similar, but they are typically used in other database management systems.

- For example, suppose we want to create a table named orders with an id column that auto-increments ***starting from 100*** with a ***step of 10***:

```sql
CREATE TABLE orders (
  id INT AUTO_INCREMENT PRIMARY KEY,
  customer_id INT,
  order_date DATE,
  amount DECIMAL(10,2)
) AUTO_INCREMENT=100, 
INCREMENT=10;
```

- Now, whenever we insert a new row into the orders table without specifying a value for the id column, MySQL will ***automatically assign*** a unique value starting from 100 with a step of 10:

```sql
INSERT INTO orders (customer_id, order_date, amount)
VALUES (1, '2022-04-01', 100.00);

-- id column will be 100

INSERT INTO orders (customer_id, order_date, amount)
VALUES (2, '2022-04-02', 200.00);

-- id column will be 110

INSERT INTO orders (customer_id, order_date, amount)
VALUES (3, '2022-04-03', 300.00);

-- id column will be 120
```

**Relationship between Primary Keys and Foreign Keys**

Primary keys and foreign keys are used to establish relationships between tables in a database system. A foreign key is a field in a table that is linked to the primary key of another table. This helps to ensure that data remains consistent and accurate throughout the database.

- To create a table with a ***foreign key***:

```sql
CREATE TABLE orders (
  order_id INT NOT NULL PRIMARY KEY,
  customer_id INT,
  order_date DATE,
  FOREIGN KEY (customer_id) REFERENCES customers (customer_id)
);
```

- To create a table with a ***composite foreign key***:

```sql
CREATE TABLE order_details (
  order_id INT,
  product_id INT,
  quantity INT,
  PRIMARY KEY (order_id, product_id),
  FOREIGN KEY (order_id) REFERENCES orders (order_id),
  FOREIGN KEY (product_id) REFERENCES products (product_id)
);
```

# SQL Syntax

MySQL syntax is the set of commands and rules used to interact with a MySQL database. It includes various types of queries, such as SELECT, INSERT, UPDATE, and DELETE, which allow you to manipulate data stored in tables. In addition, MySQL syntax also includes commands for creating tables, altering table structures, and defining relationships between tables. By understanding MySQL syntax, you can perform a wide range of operations on a MySQL database, including inserting and updating data, querying data, and managing table structures.

## Virtual Tables: JOIN and WITH

Virtual tables are temporary tables that can be created in memory during a SQL query. ***JOIN*** is a SQL keyword that is used to combine rows from two or more tables based on a related column between them. ***WITH*** is a keyword used to define a temporary table that can be referenced multiple times within a SQL query.

- To join two tables using the ***JOIN*** syntax:

```sql
SELECT *
FROM table1
JOIN table2
ON table1.column = table2.column;
```

- To join two tables using the ***WITH*** syntax:

```sql
WITH table1 AS (
  SELECT *
  FROM my_table
), table2 AS (
  SELECT *
  FROM other_table
)
SELECT *
FROM table1
JOIN table2
ON table1.column = table2.column;
```

## Grouping and Aggregation

***Grouping and aggregation*** are SQL functions that allow for the summarization of data within a table. ***GROUP BY*** is a SQL keyword that is used to group rows together based on a common column. Aggregation functions, such as ***SUM***, ***AVG***, ***MIN***, ***MAX***, and ***COUNT***, are used to calculate values within these groups. This can be useful for creating summary reports and analyzing data.

In SQL, grouping queries are used to group rows that have the same values in one or more columns. This is often used in conjunction with aggregate functions, which perform calculations on a group of rows rather than on individual rows.

The syntax for a ***grouping query*** is as follows:

```sql
SELECT column1, column2, ..., aggregate_function(column_name)
FROM table_name
WHERE condition
GROUP BY column1, column2, ...;
```

Here, column1, column2, etc. are the columns you want to group by, and aggregate_function is the function you want to apply to the grouped rows. For example, you might use the SUM function to calculate the total sales for each product category:

```sql
SELECT category, SUM(sales)
FROM sales_table
GROUP BY category;
```

This would return a result set with one row for each unique value in the category column, and the total sales for that category.

You can also use the ***HAVING*** clause to filter the results of a grouping query based on the results of an ***aggregate function***. For example, to only return categories with total sales greater than 100, you could modify the above query as follows:

```sql
SELECT category, SUM(sales)
FROM sales_table
GROUP BY category
HAVING SUM(sales) > 100;
```

This would only return rows where the sum of sales for that category is greater than 100.

Grouping queries can also be used to perform calculations on groups of rows. For example, to calculate the average sales for each category, you could use the AVG function:

```sql
SELECT category, AVG(sales)
FROM sales_table
GROUP BY category;
```

This would return the average sales for each category in the sales_table.

## LEFT JOIN, RIGHT JOIN, FULL JOIN, INNER JOIN and CROSS JOIN

Left join, right join, and full join are three types of table joins in SQL that allow you to combine data from multiple tables. Each of these joins has a different behavior, and understanding their differences is essential to writing effective SQL queries. In this blog, we'll explain each join type and provide sample MySQL code to illustrate how they work.

- ***LEFT JOIN***

A left join returns all the rows from the left table and the matching rows from the right table. If there is no match in the right table, the result set will contain NULL values in the columns from the right table.

Here's an example of a left join between two tables: customers and orders.

```sql
SELECT *
FROM customers
LEFT JOIN orders
ON customers.customer_id = orders.customer_id;
```

In this query, we're selecting all the columns from the customers table and matching them with the orders table on the customer_id column. The result set will contain all the rows from the customers table and only the matching rows from the orders table.

- ***RIGHT JOIN***

A right join is similar to a left join but returns all the rows from the right table and the matching rows from the left table. If there is no match in the left table, the result set will contain NULL values in the columns from the left table.

Here's an example of a right join between the same two tables: customers and orders.

```sql
SELECT *
FROM customers
RIGHT JOIN orders
ON customers.customer_id = orders.customer_id;
```

In this query, we're selecting all the columns from the orders table and matching them with the customers table on the customer_id column. The result set will contain all the rows from the orders table and only the matching rows from the customers table.

- ***FULL JOIN***

A full join returns all the rows from both tables, including the matching and non-matching rows. If there is no match in one table, the result set will contain NULL values in the columns from that table.

Here's an example of a full join between the same two tables: customers and orders.

```sql
SELECT *
FROM customers
FULL JOIN orders
ON customers.customer_id = orders.customer_id;
```

In this query, we're selecting all the columns from both tables and matching them on the customer_id column. The result set will contain all the rows from both tables, including the matching and non-matching rows.

- ***INNER JOIN***

An inner join is a type of join that returns only the rows from both tables that meet a specified condition. The condition is typically a matching value in a column shared between the two tables. Here's an example:

```sql
SELECT *
FROM table1
INNER JOIN table2
ON table1.column1 = table2.column2;
```

In this example, we are selecting all columns from both table1 and table2 where column1 in table1 matches column2 in table2. The result set will only include rows where this condition is true.

Inner joins are useful when you need to combine data from two tables where there is a clear relationship between the data. For example, you might use an inner join to combine order data from a sales table with customer data from a customer table based on a shared customer ID.

- ***CROSS JOIN***

A cross join is a type of join that returns the Cartesian product of two tables. In other words, it returns every possible combination of rows from both tables. Here's an example:

```sql
SELECT *
FROM table1
CROSS JOIN table2;
```

In this example, we are selecting all columns from both table1 and table2, and every possible combination of rows from both tables will be returned. This can result in a very large result set if the tables are large.

Cross joins are useful when you need to combine data from two tables where there is no clear relationship between the data. For example, you might use a cross join to generate all possible combinations of products and colors in a product catalog.
